[TOC]

# 条件查询

## 比较运算符

- 比较大小，多用于数字类型、字符串类型、日期时间类型

    | 运算符 | 含义     |
    | --- | --- |
    | = / <=> | 相等 |
    | <> / != | 不相等 |
    | >= | 大于等于 |
    | > | 大于 |
    | <= | 小于等于 |
    | < | 小于 |

- 指定范围

    与其他谓词或函数不同：在于使用了 3 个参数

    BETWEEN a AND b：介于 a 和 b 之间的数字

    ```sql
    ...
    WHERE score BETWEEN 60 AND 100;
    ```

    > 从结果集中进行查询

- 对 NULL 的比较

    选取出某些之为 `NULL` 的列数据

    - IS NULL：判断是否为 NULL
    - IS NOT NULL：判断是否不为 NULL

    > 不能对 NULL 使用比较运算符
    >
    > 使用 `<> / =` 无法选取出 NULL 的记录

- 在 / 不在列表内

    判断是否存在于列表内

    - IN (a, b, c)
    - NOT IN (a, b, c)

    ```sql
    SELECT 11 IN (1, 2, 3, 4, 5);

    SELECT 1 NOT IN (1, 2, 3, 4, 5);
    ```

    > **注意**：在使用 `IN` 和 `NOT IN` 是无法选取出 NULL 的数据

- 最大值 / 最小值

    - GREATEST (a, b, c)
    - LEAST (a, b, c)

    ```sql
    SELECT GREATEST(1, 2, 3);

    SELECT least(1, 2, 3);
    ```

    > **注意**：当表中列存在 NULL，只会返回 NULL 值

- 字符串搜索

    当需要进行字符串的 **部分一致查询** 可使用该谓词
    - 以 ** 开头：`LIKE 'A%'`，选取作为查询条件的字符串，与查询对象字符串起始部分相同记录查询
    - 以 ** 结尾：`LIKE '%B'`，与前方一致相反
    - 包含 ** 内容：`LIKE '%AB%'`，选取查询对象字符串中含有作为查询条件的字符串记录查询
    - 正则匹配：`REGEXP '[0-9]{4}'`

    > `%`：代表任意数量的字符
    >
    > `_`：代表任意 1 个字符，`WHERE str LIKE 'a___'`

### 对字符串使用不等号的注意事项

以相同字符开头的单词比不同字符开头的单词更接近

```sql
1
1-1
2
2-1

-- 进行比较时，结果：
-- '1-1' 比 '2' 小
```

> 字符串类型的数据原则上按照字典顺序进行排序，不能与数字大小顺序混淆
>
> **定长字符串和可变字符串都适用**

## 算术运算符

- 对其两边的列或值进行运算（计算或比较大小）的符号
- 括号可提升运算的优先顺序（优先运算）
- 算数运算符可进行四则运算

| 类型 | 表达式 |
| --- | --- |
| 加 | + |
| 减 | - |
| 乘 | * |
| 除 | / |
| 求余 | % |

```sql
SELECT 7 * 9;   -- 63

SELECT 8 % 3;   -- 2
```

> - 运算以 **行** 为单位执行
> 
> - `+` 号前后如果是数字或数字类型的列名，会返回加法运算后的结果，**不能用于字符串拼接**
>
> - 所有包含 `NULL` 的计算，结果肯定是 `NULL`

## 逻辑运算符

- 通过逻辑运算符，可将多个查询条件进行组合
- 通过 NOT 运算符可生成 “不是 ~” 的查询条件
- 将根据逻辑运算符对真值进行的操作及其结果汇总成的表称为 **真值表**
- SQL 中逻辑运算包含对真、假和不确定进行运算的三值逻辑

### AND 和 OR

- `AND`：`&&`，在其两侧的查询条件都成立时整个查询条件才成立，并且
-  `OR`：`||`，在其两侧的查询条件任意一个成立时整个查询条件都成立，或

```sql
...
WHERE score <= 60 AND score >= 100 AND sex = '女';
```

> `AND` 优先于 `OR`
>
> 可使用半角括号 `()` 将 `OR` 及其两侧的查询条件括起来，使其优先判断 `OR`

### NOT

`NOT`：`!`，指定 不是~ 的否定条件时，需要使用 `<>` 运算符，并使用范围更广的运算符 `NOT`

> - `NOT` 不能单独使用，必须和其他查询条件组合使用
>
> - `NOT` 用来否定某一条件，但不能滥用

### 逻辑运算和真值

`NOT`、`AND` 和 `OR` 称为 **逻辑运算符**，对 **真值** 进行操作的意思

真值：值为 **TRUE** 或 **FALSE** 其中之一的值

逻辑运算对比较运算符等返回的真值进行操作

- **AND**（逻辑积）

  | P    | Q    | P AND Q |
  | ---- | ---- | ------- |
  | T    | T    | T       |
  | T    | F    | F       |
  | F    | T    | F       |
  | F    | F    | F       |

- **OR**（逻辑和）

  | P    | Q    | P OR Q |
  | ---- | ---- | ------ |
  | T    | T    | T      |
  | T    | F    | T      |
  | F    | T    | T      |
  | F    | F    | F      |

- **NOT**

  | P    | NOT P |
  | ---- | ----- |
  | T    | F     |
  | F    | T     |
