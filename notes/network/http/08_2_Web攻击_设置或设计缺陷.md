[TOC]

## 因设置或设计缺陷引发的安全漏洞

### 强制浏览

安置在 Web 服务器公开目录下的文件中，浏览那些原本非自愿公开的文件

-  泄露顾客个人信息等重要情报
- 泄露原本需要具有访问权限的用户可查阅的信息内容
- 泄露未外联到外界的文件

> **对那些原本不愿公开的文件，为了保证安全隐蔽其 URL**
>
> **意味着可浏览 URL 对应的文件，直接显示容易推测的文件名或文件目录索引时，通过某些方法可能会使 URL 产生泄露**

1. **文件目录一览**

   `http://www.example.com/log/`

   通过指定目录名称，即可在文件一览中看到显示文件名

2. **容易被推测的文件名及目录名**

   `http://www.example.com/entry/entry_081202.log`

   文件名称推测，可能下个文件名为 `081203.log`

3. **备份文件**

   ```shell
   https://example.com/ci-bin/entry.cgi	#原始文件
   https://example.com/ci-bin/entry.cgi~	#备份文件
   https://example.com/ci-bin/entry.bak	#备份文件
   ```

   由编辑软件生成的备份文件物质性权限，可能直接以源代码形式显示

4. **经认证可显示的文件**

   直接通过 URL 访问原本必须经过认证才能在 Web 页面上使用的文件（HTML、图片、PDF、CSS 等）

### 不正确错误消息处理

Web 应用错误信息内包含对攻击者有用的信息

- Web 应用抛出的错误消息
- 数据库等系统抛出的错误消息

> **对攻击者，详细的错误消息是给他们下次攻击的提示**

1. Web 抛出的错误消息

   在输入表单内的邮件地址及密码匹配错误时，会提示错误信息（若邮箱存在密码错误则提示密码错误等）

   >  **建议错误提示仅保留到 “认证错误、账户密码错误”，让其起到混淆作用**

2. 数据库系统抛出错误消息

   搜索功能，用于检索数据，当输入未预料的字符串时，会提示数据库错误

   **从 SQL 有关错误信息，对其可判断选用的数据库，或 SQL 片段**

   - PHP 或 ASP 等脚本错误
   - 数据库或中间件错误
   - Web 服务器错误

### 开放重定向

对指定任意 URL 作重定向跳转功能，假如指定重定向 URL 到某个具有恶意的网站，会诱导其进入

```shell
http://example.com/?redirect=http://www.baidu.com

# 把重定向指向指定的参数改写成恶意网站对应连接
http://example.com/?redirect=http://hackr.com
```

> **可信度高的网站如果开放重定向功能，则可能被选中并用来作为钓鱼攻击的跳板**

